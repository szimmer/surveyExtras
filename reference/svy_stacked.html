<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Design-based test comparing subpopulations to a population — svy_stacked • surveyExtras</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Design-based test comparing subpopulations to a population — svy_stacked"><meta name="description" content="Calculate a t-test comparing a subpopulation to the overall population.
For example, comparing a state estimate to the national or all adults to employed adults."><meta property="og:description" content="Calculate a t-test comparing a subpopulation to the overall population.
For example, comparing a state estimate to the national or all adults to employed adults."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">surveyExtras</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Design-based test comparing subpopulations to a population</h1>

      <div class="d-none name"><code>svy_stacked.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculate a t-test comparing a subpopulation to the overall population.
For example, comparing a state estimate to the national or all adults to employed adults.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">svy_stacked</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  svydestype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"as_survey_design"</span>, <span class="st">"as_survey_rep"</span>, <span class="st">"svydesign"</span>, <span class="st">"svrepdesign"</span><span class="op">)</span>,</span>
<span>  <span class="va">outcome_variable</span>,</span>
<span>  <span class="va">subpop_variable</span>,</span>
<span>  subset_statement <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dftype <span class="op">=</span> <span class="st">"sub"</span>,</span>
<span>  ddf <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>a data frame or tibble to look up formulas and necessary variables for design objects</p></dd>


<dt id="arg-svydestype">svydestype<a class="anchor" aria-label="anchor" href="#arg-svydestype"></a></dt>
<dd><p>a character string indicating the type of survey design object to create.
Options are "svydesign" or "svrepdesign".</p></dd>


<dt id="arg-outcome-variable">outcome_variable<a class="anchor" aria-label="anchor" href="#arg-outcome-variable"></a></dt>
<dd><p>an outcome variable, specified as a character</p></dd>


<dt id="arg-subpop-variable">subpop_variable<a class="anchor" aria-label="anchor" href="#arg-subpop-variable"></a></dt>
<dd><p>a variable, specified as character, which defines the subpopulation(s)
comparing to the full population</p></dd>


<dt id="arg-subset-statement">subset_statement<a class="anchor" aria-label="anchor" href="#arg-subset-statement"></a></dt>
<dd><p>(optional) any necessary subsetting to do before the analysis, specified
as a character (e.g., "mpg &gt; 4")</p></dd>


<dt id="arg-dftype">dftype<a class="anchor" aria-label="anchor" href="#arg-dftype"></a></dt>
<dd><p>specify what type of degrees of freedom to use either specified as one of
c("entire", "full", "sub", "manual") or a specified positive number where "entire" uses the
degrees of freedom for the entire design, "full" uses the degrees of freedom for the design after
applying the subset, this will be the same as "entire" if there is no subset, "sub" which uses
the degrees of freedom after applying both the subset and the subpopulation or "manual" where the
degrees of freedom is specified in ddf</p></dd>


<dt id="arg-ddf">ddf<a class="anchor" aria-label="anchor" href="#arg-ddf"></a></dt>
<dd><p>a positive value for degrees of freedom if using manual degrees of freedom</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>arguments to pass to the survey design constructor function such as weights, strata,
and cluster ids. See <code><a href="http://gdfe.co/srvyr/reference/as_survey_design.html" class="external-link">srvyr::as_survey_design()</a></code>, <code><a href="http://gdfe.co/srvyr/reference/as_survey_rep.html" class="external-link">srvyr::as_survey_rep()</a></code>,
<code><a href="https://rdrr.io/pkg/survey/man/svydesign.html" class="external-link">survey::svydesign()</a></code>, or <code><a href="https://rdrr.io/pkg/survey/man/svrepdesign.html" class="external-link">survey::svrepdesign()</a></code>) for more detail - do NOT include the data.</p></dd>

</dl></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">api</span>, package <span class="op">=</span> <span class="st">"survey"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">svy_stacked</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">apistrat</span>,</span></span>
<span class="r-in"><span>  svydestype <span class="op">=</span> <span class="st">"svydesign"</span>,</span></span>
<span class="r-in"><span>  outcome_variable <span class="op">=</span> <span class="st">"api00"</span>,</span></span>
<span class="r-in"><span>  subpop_variable <span class="op">=</span> <span class="st">"stype"</span>,</span></span>
<span class="r-in"><span>  dftype <span class="op">=</span> <span class="st">"sub"</span>,</span></span>
<span class="r-in"><span>  strata <span class="op">=</span> <span class="op">~</span><span class="va">stype</span>,</span></span>
<span class="r-in"><span>  weights <span class="op">=</span> <span class="op">~</span><span class="va">pw</span>,</span></span>
<span class="r-in"><span>  ids <span class="op">=</span> <span class="op">~</span><span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required namespace: testthat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Group  estimate  statistic    p.value df</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     E  12.14264  0.7721989 0.44183616 99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     H -36.46736 -2.0144633 0.04946667 49</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     M -25.68736 -1.3447476 0.18489860 49</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">svy_stacked</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">apistrat</span>,</span></span>
<span class="r-in"><span>  svydestype <span class="op">=</span> <span class="st">"as_survey_design"</span>,</span></span>
<span class="r-in"><span>  outcome_variable <span class="op">=</span> <span class="st">"api00"</span>,</span></span>
<span class="r-in"><span>  subpop_variable <span class="op">=</span> <span class="st">"stype"</span>,</span></span>
<span class="r-in"><span>  dftype <span class="op">=</span> <span class="st">"sub"</span>,</span></span>
<span class="r-in"><span>  strata <span class="op">=</span> <span class="va">stype</span>,</span></span>
<span class="r-in"><span>  weights <span class="op">=</span> <span class="va">pw</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Group  estimate  statistic    p.value df</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     E  12.14264  0.7721989 0.44183616 99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     H -36.46736 -2.0144633 0.04946667 49</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     M -25.68736 -1.3447476 0.18489860 49</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/is_installed.html" class="external-link">is_installed</a></span><span class="op">(</span><span class="st">"srvyrexploR"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co"># Compare each northeastern state average energy expenditure to all the states in the northeast</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">recs_2020</span>, package <span class="op">=</span> <span class="st">"srvyrexploR"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">svy_stacked</span><span class="op">(</span></span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">recs_2020</span>,</span></span>
<span class="r-in"><span>    svydestype <span class="op">=</span> <span class="st">"as_survey_rep"</span>,</span></span>
<span class="r-in"><span>    outcome_variable <span class="op">=</span> <span class="st">"TOTALDOL"</span>,</span></span>
<span class="r-in"><span>    subpop_variable <span class="op">=</span> <span class="st">"state_postal"</span>,</span></span>
<span class="r-in"><span>    subset_statement <span class="op">=</span> <span class="st">"REGIONC == 'NORTHEAST'"</span>,</span></span>
<span class="r-in"><span>    dftype <span class="op">=</span> <span class="st">"full"</span>,</span></span>
<span class="r-in"><span>    weights <span class="op">=</span> <span class="va">NWEIGHT</span>,</span></span>
<span class="r-in"><span>    repweights <span class="op">=</span> <span class="va">NWEIGHT1</span><span class="op">:</span><span class="va">NWEIGHT60</span>,</span></span>
<span class="r-in"><span>    type <span class="op">=</span> <span class="st">"JK1"</span>,</span></span>
<span class="r-in"><span>    scale <span class="op">=</span> <span class="fl">59</span> <span class="op">/</span> <span class="fl">60</span>,</span></span>
<span class="r-in"><span>    mse <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Group   estimate  statistic      p.value df</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    CT  544.62109  5.6341492 5.187204e-07 59</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    ME   41.46504  0.4896011 6.262317e-01 59</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    MA  190.41422  3.7962617 3.489782e-04 59</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    NH  267.07308  2.7024978 8.973627e-03 59</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    NJ -228.59735 -4.1848175 9.626176e-05 59</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    NY   56.68835  1.4410281 1.548632e-01 59</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    PA -248.17423 -6.0496585 1.069521e-07 59</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8    RI  354.21725  3.4053146 1.194475e-03 59</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9    VT  144.34982  1.8167289 7.433902e-02 59</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Stephanie Zimmer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

