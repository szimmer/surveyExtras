% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/svy_stacked.R
\name{svy_stacked}
\alias{svy_stacked}
\title{Design-based test comparing subpopulations to a population}
\usage{
svy_stacked(
  data,
  svydestype = c("as_survey_design", "as_survey_rep", "svydesign", "svrepdesign"),
  outcome_variable,
  subpop_variable,
  subset_statement = NULL,
  dftype = "sub",
  ddf = NULL,
  ...
)
}
\arguments{
\item{data}{a data frame or tibble to look up formulas and necessary variables for design objects}

\item{svydestype}{a character string indicating the type of survey design object to create.
Options are "svydesign" or "svrepdesign".}

\item{outcome_variable}{an outcome variable, specified as a character}

\item{subpop_variable}{a variable, specified as character, which defines the subpopulation(s)
comparing to the full population}

\item{subset_statement}{(optional) any necessary subsetting to do before the analysis, specified
as a character (e.g., "mpg > 4")}

\item{dftype}{specify what type of degrees of freedom to use either specified as one of
c("entire", "full", "sub", "manual") or a specified positive number where "entire" uses the
degrees of freedom for the entire design, "full" uses the degrees of freedom for the design after
applying the subset, this will be the same as "entire" if there is no subset, "sub" which uses
the degrees of freedom after applying both the subset and the subpopulation or "manual" where the
degrees of freedom is specified in ddf}

\item{ddf}{a positive value for degrees of freedom if using manual degrees of freedom}

\item{...}{arguments to pass to the survey design constructor function such as weights, strata,
and cluster ids. See \code{\link[srvyr:as_survey_design]{srvyr::as_survey_design()}}, \code{\link[srvyr:as_survey_rep]{srvyr::as_survey_rep()}},
\code{\link[survey:svydesign]{survey::svydesign()}}, or \code{\link[survey:svrepdesign]{survey::svrepdesign()}}) for more detail - do NOT include the data.}
}
\description{
Calculate a t-test comparing a subpopulation to the overall population.
For example, comparing a state estimate to the national or all adults to employed adults.
}
\examples{
data(api, package = "survey")
svy_stacked(
  data = apistrat,
  svydestype = "svydesign",
  outcome_variable = "api00",
  subpop_variable = "stype",
  dftype = "sub",
  strata = ~stype,
  weights = ~pw,
  ids = ~1
)

svy_stacked(
  data = apistrat,
  svydestype = "as_survey_design",
  outcome_variable = "api00",
  subpop_variable = "stype",
  dftype = "sub",
  strata = stype,
  weights = pw
)

if (rlang::is_installed("srvyrexploR")) {
  # Compare each northeastern state average energy expenditure to all the states in the northeast
  data(recs_2020, package = "srvyrexploR")
  svy_stacked(
    data = recs_2020,
    svydestype = "as_survey_rep",
    outcome_variable = "TOTALDOL",
    subpop_variable = "state_postal",
    subset_statement = "REGIONC == 'NORTHEAST'",
    dftype = "full",
    weights = NWEIGHT,
    repweights = NWEIGHT1:NWEIGHT60,
    type = "JK1",
    scale = 59 / 60,
    mse = TRUE
  )
}
}
